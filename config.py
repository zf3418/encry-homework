# config.py

# ====================
# 加密规则 (Strict) - 用于识别真实敏感信息
# ====================
PATTERNS = {
    # 手机号：严格匹配国内手机格式 (1开头)
    "PHONE": r'\b1[3-9]\d{9}\b',
    
    # 身份证：18位数字
    "ID_CARD": r'\b\d{18}\b',
    
    # 银行卡：16位数字
    "CREDIT_CARD": r'\b\d{16}\b',
    
    # 邮箱
    "EMAIL": r'([a-zA-Z0-9_.+-]+)@([a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)',
}

# ====================
# 解密规则 (Broad) - 用于识别密文并还原
# ====================
# 核心修改：FPE 加密后的密文依然是数字，但不一定符合业务规则(如不一定1开头)
# 因此解密时，只要长度对上，就认为是密文
DECRYPT_PATTERNS = {
    # 手机号密文：任意 11 位数字 (不再限制 1 开头)
    "PHONE_CIPHER": r'\b\d{11}\b',
    
    # 身份证密文：任意 18 位数字
    "ID_CARD_CIPHER": r'\b\d{18}\b',
    
    # 银行卡密文：任意 16 位数字
    "CREDIT_CARD_CIPHER": r'\b\d{16}\b',
    
    # 邮箱：结构通常保持不变，复用即可
    "EMAIL": r'([a-zA-Z0-9_.+-]+)@([a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)',
}

# 模拟的系统盐值
SYSTEM_SALT = b'MySystemSalt_2024'